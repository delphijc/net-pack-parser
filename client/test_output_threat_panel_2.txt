
> client@0.0.0 test
> vitest run src/components/ThreatPanel.test.tsx


 RUN  v4.0.14 /home/jaysoncavendish/Projects/net-pack-parser/client

stdout | src/components/ThreatPanel.test.tsx > ThreatPanel > renders "No threats detected." when no threats are provided
ThreatPanel threats: []

stdout | src/components/ThreatPanel.test.tsx > ThreatPanel > renders a list of threats when provided
ThreatPanel threats: [
  {
    id: 'threat-1',
    packetId: 'packet-1',
    severity: 'critical',
    type: 'SQL Injection',
    description: 'Potential SQL Injection detected in HTTP request (encoding: none)',
    mitreAttack: [ 'T1190' ],
    timestamp: 1678886400000,
    falsePositive: false,
    confirmed: false,
    matchDetails: [ [Object] ]
  },
  {
    id: 'threat-2',
    packetId: 'packet-2',
    severity: 'critical',
    type: 'SQL Injection',
    description: 'Potential SQL Injection detected in HTTP request (encoding: url)',
    mitreAttack: [ 'T1190' ],
    timestamp: 1678886460000,
    falsePositive: true,
    confirmed: false,
    matchDetails: [ [Object] ]
  }
]

stdout | src/components/ThreatPanel.test.tsx > ThreatPanel > calls onThreatClick when a threat item is clicked
ThreatPanel threats: [
  {
    id: 'threat-1',
    packetId: 'packet-1',
    severity: 'critical',
    type: 'SQL Injection',
    description: 'Potential SQL Injection detected in HTTP request (encoding: none)',
    mitreAttack: [ 'T1190' ],
    timestamp: 1678886400000,
    falsePositive: false,
    confirmed: false,
    matchDetails: [ [Object] ]
  },
  {
    id: 'threat-2',
    packetId: 'packet-2',
    severity: 'critical',
    type: 'SQL Injection',
    description: 'Potential SQL Injection detected in HTTP request (encoding: url)',
    mitreAttack: [ 'T1190' ],
    timestamp: 1678886460000,
    falsePositive: true,
    confirmed: false,
    matchDetails: [ [Object] ]
  }
]

stdout | src/components/ThreatPanel.test.tsx > ThreatPanel > calls onUpdateThreatStatus with "falsePositive" when "Mark as False Positive" button is clicked
ThreatPanel threats: [
  {
    id: 'threat-1',
    packetId: 'packet-1',
    severity: 'critical',
    type: 'SQL Injection',
    description: 'Potential SQL Injection detected in HTTP request (encoding: none)',
    mitreAttack: [ 'T1190' ],
    timestamp: 1678886400000,
    falsePositive: false,
    confirmed: false,
    matchDetails: [ [Object] ]
  },
  {
    id: 'threat-2',
    packetId: 'packet-2',
    severity: 'critical',
    type: 'SQL Injection',
    description: 'Potential SQL Injection detected in HTTP request (encoding: url)',
    mitreAttack: [ 'T1190' ],
    timestamp: 1678886460000,
    falsePositive: true,
    confirmed: false,
    matchDetails: [ [Object] ]
  }
]

stdout | src/components/ThreatPanel.test.tsx > ThreatPanel > calls onUpdateThreatStatus with "confirmed" when "Mark as Confirmed" button is clicked
ThreatPanel threats: [
  {
    id: 'threat-1',
    packetId: 'packet-1',
    severity: 'critical',
    type: 'SQL Injection',
    description: 'Potential SQL Injection detected in HTTP request (encoding: none)',
    mitreAttack: [ 'T1190' ],
    timestamp: 1678886400000,
    falsePositive: false,
    confirmed: false,
    matchDetails: [ [Object] ]
  },
  {
    id: 'threat-2',
    packetId: 'packet-2',
    severity: 'critical',
    type: 'SQL Injection',
    description: 'Potential SQL Injection detected in HTTP request (encoding: url)',
    mitreAttack: [ 'T1190' ],
    timestamp: 1678886460000,
    falsePositive: true,
    confirmed: false,
    matchDetails: [ [Object] ]
  }
]

stdout | src/components/ThreatPanel.test.tsx > ThreatPanel > disables "Mark as False Positive" button if threat is already falsePositive
ThreatPanel threats: [
  {
    id: 'threat-1',
    packetId: 'packet-1',
    severity: 'critical',
    type: 'SQL Injection',
    description: 'Potential SQL Injection detected in HTTP request (encoding: none)',
    mitreAttack: [ 'T1190' ],
    timestamp: 1678886400000,
    falsePositive: false,
    confirmed: false,
    matchDetails: [ [Object] ]
  },
  {
    id: 'threat-2',
    packetId: 'packet-2',
    severity: 'critical',
    type: 'SQL Injection',
    description: 'Potential SQL Injection detected in HTTP request (encoding: url)',
    mitreAttack: [ 'T1190' ],
    timestamp: 1678886460000,
    falsePositive: true,
    confirmed: false,
    matchDetails: [ [Object] ]
  }
]

stdout | src/components/ThreatPanel.test.tsx > ThreatPanel > disables "Mark as Confirmed" button if threat is already confirmed
ThreatPanel threats: [
  {
    id: 'threat-1',
    packetId: 'packet-1',
    severity: 'critical',
    type: 'SQL Injection',
    description: 'Potential SQL Injection detected in HTTP request (encoding: none)',
    mitreAttack: [ 'T1190' ],
    timestamp: 1678886400000,
    falsePositive: false,
    confirmed: true,
    matchDetails: [ [Object] ]
  },
  {
    id: 'threat-2',
    packetId: 'packet-2',
    severity: 'critical',
    type: 'SQL Injection',
    description: 'Potential SQL Injection detected in HTTP request (encoding: url)',
    mitreAttack: [ 'T1190' ],
    timestamp: 1678886460000,
    falsePositive: true,
    confirmed: false,
    matchDetails: [ [Object] ]
  }
]

 ✓ src/components/ThreatPanel.test.tsx (7 tests) 1143ms
     ✓ calls onUpdateThreatStatus with "falsePositive" when "Mark as False Positive" button is clicked  394ms

 Test Files  1 passed (1)
      Tests  7 passed (7)
   Start at  12:16:51
   Duration  4.05s (transform 287ms, setup 272ms, import 395ms, tests 1.14s, environment 1.44s)

