
> client@0.0.0 test
> vitest run


[1m[46m RUN [49m[22m [36mv4.0.14 [39m[90m/Users/delphijc/Projects/net-pack-parser/client[39m

[90mstdout[2m | src/utils/stringExtractor.test.ts[2m > [22m[2mstringExtractor[2m > [22m[2mshould post a message to the worker with the correct payload
[22m[39m[StringExtractor] Sending request ac6dd0f3-6160-4ac1-907f-834f3a5665f6 to worker

[90mstdout[2m | src/utils/stringExtractor.test.ts[2m > [22m[2mstringExtractor[2m > [22m[2mshould resolve with extracted strings on success
[22m[39m[StringExtractor] Sending request b2927b64-a53a-45d7-81c8-e11b06d47279 to worker
[StringExtractor] Received response for b2927b64-a53a-45d7-81c8-e11b06d47279, status: success

[90mstdout[2m | src/utils/stringExtractor.test.ts[2m > [22m[2mstringExtractor[2m > [22m[2mshould reject with an error on failure
[22m[39m[StringExtractor] Sending request 95dc43d7-41d1-49d6-aecd-a89dd0b2a620 to worker
[StringExtractor] Received response for 95dc43d7-41d1-49d6-aecd-a89dd0b2a620, status: error

[90mstdout[2m | src/utils/stringExtractor.test.ts[2m > [22m[2mstringExtractor[2m > [22m[2mshould reject with a default error message if none provided on failure
[22m[39m[StringExtractor] Sending request 01be6ac2-35bc-4e4d-8601-708f9a6fb672 to worker
[StringExtractor] Received response for 01be6ac2-35bc-4e4d-8601-708f9a6fb672, status: error

[90mstdout[2m | src/utils/stringExtractor.test.ts[2m > [22m[2mstringExtractor[2m > [22m[2mshould reject when worker throws an error event
[22m[39m[StringExtractor] Sending request 14525c72-48b0-4c3c-ad27-ff9920ee0588 to worker

[90mstderr[2m | src/utils/stringExtractor.test.ts[2m > [22m[2mstringExtractor[2m > [22m[2mshould reject when worker throws an error event
[22m[39mWorker error: { message: [32m'Worker crashed'[39m }

 [32mâœ“[39m src/utils/stringExtractor.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 35[2mms[22m[39m
[90mstdout[2m | src/services/pcapParser.test.ts[2m > [22m[2mpcapParser[2m > [22m[2mshould parse PCAP binary data correctly
[22m[39m[StringExtractor] Sending request 87a083da-4fcb-458d-8e92-665e2e0d617a to worker

[90mstdout[2m | src/components/SettingsPage.test.tsx
[22m[39mIndexedDB upgrade complete.

[90mstdout[2m | src/components/SettingsPage.test.tsx
[22m[39mIndexedDB for File References opened successfully.

[90mstdout[2m | src/components/SettingsPage.test.tsx[2m > [22m[2mSettingsPage[2m > [22m[2mshows a confirmation dialog when "Clear All Local Data" is clicked
[22m[39mIndexedDB opened successfully for Chain of Custody.

[90mstderr[2m | src/components/FileInfo.test.tsx[2m > [22m[2mFileInfo[2m > [22m[2mshould display "Verification Error" on API failure
[22m[39mError during integrity verification: Error: Test error
    at [90m/Users/delphijc/Projects/net-pack-parser/client/[39msrc/components/FileInfo.test.tsx:89:22
    at Mock [90m(file:///Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:280:34[90m)[39m
    at handleVerify [90m(/Users/delphijc/Projects/net-pack-parser/client/[39msrc/components/FileInfo.tsx:28:28[90m)[39m
    at executeDispatch [90m(/Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom-client.development.js:19116:9[90m)[39m
    at runWithFiberInDEV [90m(/Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom-client.development.js:874:13[90m)[39m
    at processDispatchQueue [90m(/Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom-client.development.js:19166:19[90m)[39m
    at [90m/Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom-client.development.js:19767:9
    at batchedUpdates$1 [90m(/Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom-client.development.js:3255:40[90m)[39m
    at dispatchEventForPluginEventSystem [90m(/Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom-client.development.js:19320:7[90m)[39m
    at dispatchEvent [90m(/Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom-client.development.js:23585:11[90m)[39m

 [32mâœ“[39m src/components/FileInfo.test.tsx [2m([22m[2m4 tests[22m[2m)[22m[32m 255[2mms[22m[39m
[90mstdout[2m | src/components/PacketDetailView.test.tsx
[22m[39mIndexedDB upgrade complete.

[90mstdout[2m | src/components/PacketDetailView.test.tsx
[22m[39mIndexedDB for File References opened successfully.

[90mstdout[2m | src/components/PacketDetailView.test.tsx
[22m[39mIndexedDB opened successfully for Chain of Custody.

 [32mâœ“[39m src/components/ExtractedStringsTab.test.tsx [2m([22m[2m6 tests[22m[2m)[22m[33m 325[2mms[22m[39m
[90mstdout[2m | src/components/SettingsPage.test.tsx[2m > [22m[2mSettingsPage[2m > [22m[2mcalls clearAll when confirmation is accepted
[22m[39mAll File Chain of Custody events cleared.

[90mstderr[2m | src/services/pcapParser.test.ts[2m > [22m[2mpcapParser[2m > [22m[2mshould parse PCAP binary data correctly
[22m[39mError extracting strings for packet b94ae6ac-86b6-4c08-8f26-2d1a7f0b8fad: Error: String extraction timed out
    at Timeout._onTimeout [90m(/Users/delphijc/Projects/net-pack-parser/client/[39msrc/services/pcapParser.ts:168:26[90m)[39m
[90m    at listOnTimeout (node:internal/timers:605:17)[39m
[90m    at processTimers (node:internal/timers:541:7)[39m

 [32mâœ“[39m src/services/pcapParser.test.ts [2m([22m[2m3 tests[22m[2m)[22m[33m 513[2mms[22m[39m
     [33m[2mâœ“[22m[39m should parse PCAP binary data correctly [33m 505[2mms[22m[39m
 [32mâœ“[39m src/components/ThreatPanel.test.tsx [2m([22m[2m5 tests[22m[2m)[22m[33m 328[2mms[22m[39m
 [32mâœ“[39m src/components/PacketList.integration.test.tsx [2m([22m[2m7 tests[22m[2m)[22m[33m 502[2mms[22m[39m
 [32mâœ“[39m src/components/SettingsPage.test.tsx [2m([22m[2m8 tests[22m[2m)[22m[33m 664[2mms[22m[39m
 [32mâœ“[39m src/components/ThreatPanel.xss.test.tsx [2m([22m[2m1 test[22m[2m)[22m[32m 119[2mms[22m[39m
 [32mâœ“[39m src/components/PacketDetailView.test.tsx [2m([22m[2m6 tests[22m[2m)[22m[33m 592[2mms[22m[39m
[90mstderr[2m | src/components/FilesTab.test.tsx[2m > [22m[2mFilesTab[2m > [22m[2mrenders detected files
[22m[39mIn HTML, whitespace text nodes cannot be a child of <tr>. Make sure you don't have any extra whitespace between tags on each line of your source code.
This will cause a hydration error.

  <FilesTab packet={{id:"packet-1", ...}}>
    <div className="p-4">
      <Table>
        <div className="relative w...">
          <table ref={null} className="w-full cap...">
            <TableCaption>
            <TableHeader>
            <TableBody>
              <tbody ref={null} className={"[&_tr:la..."}>
                <TableRow>
>                 <tr ref={null} className="border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted">
                    <TableCell>
                    <TableCell>
                    <TableCell>
                    <TableCell>
>                   {" "}
                    ...


[90mstdout[2m | src/components/FilesTab.test.tsx[2m > [22m[2mFilesTab[2m > [22m[2mhandles file download
[22m[39mDownloaded file: test.txt, Hash: hash123
Chain of Custody event logged

[90mstderr[2m | src/components/FilesTab.test.tsx[2m > [22m[2mFilesTab[2m > [22m[2mdisplays message when no files detected
[22m[39mAn update to FilesTab inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

Not implemented: navigation to another Document
 [32mâœ“[39m src/components/FilesTab.test.tsx [2m([22m[2m3 tests[22m[2m)[22m[32m 70[2mms[22m[39m
[90mstderr[2m | src/components/parser/PcapUpload.test.tsx[2m > [22m[2mPcapUpload Component[2m > [22m[2mrenders correctly
[22m[39mAn update to ChainOfCustodyLog inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 [32mâœ“[39m src/components/parser/PcapUpload.test.tsx [2m([22m[2m3 tests[22m[2m)[22m[32m 93[2mms[22m[39m
 [32mâœ“[39m src/components/FalsePositivesTab.test.tsx [2m([22m[2m3 tests[22m[2m)[22m[32m 97[2mms[22m[39m
 [32mâœ“[39m src/components/FilterBar.test.tsx [2m([22m[2m5 tests[22m[2m)[22m[32m 51[2mms[22m[39m
 [32mâœ“[39m src/components/ProtocolFilter.test.tsx [2m([22m[2m5 tests[22m[2m)[22m[32m 65[2mms[22m[39m
 [32mâœ“[39m src/utils/stringExtractorCore.test.ts [2m([22m[2m13 tests[22m[2m)[22m[32m 9[2mms[22m[39m
 [32mâœ“[39m src/services/iocService.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 48[2mms[22m[39m
[90mstderr[2m | src/utils/dataImportExport.test.ts[2m > [22m[2mdataImportExport[2m > [22m[2mimportDataFromJson[2m > [22m[2mshould fail if the file format is invalid
[22m[39mImport failed: Error: Invalid import file format: missing metadata or data section.
    at Module.importDataFromJson [90m(/Users/delphijc/Projects/net-pack-parser/client/[39msrc/utils/dataImportExport.ts:86:13[90m)[39m
    at [90m/Users/delphijc/Projects/net-pack-parser/client/[39msrc/utils/dataImportExport.test.ts:163:22
    at [90mfile:///Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m

[90mstderr[2m | src/utils/dataImportExport.test.ts[2m > [22m[2mdataImportExport[2m > [22m[2mimportDataFromJson[2m > [22m[2mshould fail if the schema version is different
[22m[39mImport failed: Error: Invalid schema version. Expected 1.0, but file is version 0.9.
    at Module.importDataFromJson [90m(/Users/delphijc/Projects/net-pack-parser/client/[39msrc/utils/dataImportExport.ts:93:13[90m)[39m
    at [90m/Users/delphijc/Projects/net-pack-parser/client/[39msrc/utils/dataImportExport.test.ts:180:22
    at [90mfile:///Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/delphijc/Projects/net-pack-parser/client/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m

 [32mâœ“[39m src/utils/dataImportExport.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 18[2mms[22m[39m
 [32mâœ“[39m src/utils/sensitiveDataDetector.test.ts [2m([22m[2m7 tests[22m[2m)[22m[32m 6[2mms[22m[39m
 [32mâœ“[39m src/utils/sqlInjectionDetector.test.ts [2m([22m[2m17 tests[22m[2m)[22m[32m 6[2mms[22m[39m
 [32mâœ“[39m src/utils/hashGenerator.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 6[2mms[22m[39m
 [32mâœ“[39m src/services/localStorage.test.ts [2m([22m[2m7 tests[22m[2m)[22m[32m 14[2mms[22m[39m
 [32mâœ“[39m src/utils/fileExtractor.test.ts [2m([22m[2m20 tests[22m[2m)[22m[32m 13[2mms[22m[39m
 [32mâœ“[39m src/utils/bpfFilter.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 3[2mms[22m[39m
 [32mâœ“[39m src/utils/xssDetector.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 12[2mms[22m[39m
 [32mâœ“[39m src/utils/pcapUtils.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 5[2mms[22m[39m
 [32mâœ“[39m src/utils/sqlInjectionPatterns.test.ts [2m([22m[2m18 tests[22m[2m)[22m[32m 5[2mms[22m[39m
 [32mâœ“[39m src/utils/multiCriteriaSearch.test.ts [2m([22m[2m11 tests[22m[2m)[22m[32m 5[2mms[22m[39m
 [32mâœ“[39m src/components/HexDumpViewer.test.tsx [2m([22m[2m7 tests[22m[2m)[22m[32m 2[2mms[22m[39m
 [32mâœ“[39m src/utils/iocDetector.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 5[2mms[22m[39m
 [32mâœ“[39m src/utils/commandInjectionDetector.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 3[2mms[22m[39m
 [32mâœ“[39m src/utils/protocolDetector.test.ts [2m([22m[2m17 tests[22m[2m)[22m[32m 7[2mms[22m[39m
 [32mâœ“[39m src/utils/directoryTraversalDetector.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 4[2mms[22m[39m
 [32mâœ“[39m src/store/alertStore.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 4[2mms[22m[39m
 [32mâœ“[39m src/components/AdvancedSearchPanel.test.tsx [2m([22m[2m6 tests[22m[2m)[22m[33m 2223[2mms[22m[39m
     [33m[2mâœ“[22m[39m renders all search fields correctly [33m 344[2mms[22m[39m
     [33m[2mâœ“[22m[39m allows entering criteria and submitting search [33m 909[2mms[22m[39m
     [33m[2mâœ“[22m[39m saves a new search configuration [33m 501[2mms[22m[39m
 [32mâœ“[39m src/services/mitreService.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 2[2mms[22m[39m
 [32mâœ“[39m src/utils/pcapUtils.verification.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 1[2mms[22m[39m
 [32mâœ“[39m src/services/yaraEngine.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 1[2mms[22m[39m
[31mâ¯â¯â¯â¯â¯â¯[39m[1m[41m Unhandled Errors [49m[22m[31mâ¯â¯â¯â¯â¯â¯[39m
[31m[1m
Vitest caught 1 unhandled error during the test run.
This might cause false positive tests. Resolve unhandled errors to make sure your tests are not affected.[22m[39m

[31mâ¯â¯â¯â¯[39m[1m[41m Unhandled Rejection [49m[22m[31mâ¯â¯â¯â¯â¯[39m
[31m[1mError[22m: Worker crashed[39m
[36m [2mâ¯[22m src/utils/stringExtractor.ts:[2m49:7[22m[39m
    [90m 47| [39m  pendingRequests[33m.[39m[34mforEach[39m((pending) [33m=>[39m {
    [90m 48| [39m    pending[33m.[39m[34mreject[39m(
    [90m 49| [39m      [35mnew[39m [33mError[39m(error[33m.[39mmessage [33m||[39m [32m'Error in string extraction worker'[39m)[33m,[39m
    [90m   | [39m      [31m^[39m
    [90m 50| [39m    )[33m;[39m
    [90m 51| [39m  })[33m;[39m
[90m [2mâ¯[22m MockWorker.stringExtractionWorker.onerror src/utils/stringExtractor.ts:[2m47:19[22m[39m
[90m [2mâ¯[22m MockWorker.emitError src/utils/stringExtractor.test.ts:[2m29:12[22m[39m
[90m [2mâ¯[22m src/utils/stringExtractor.test.ts:[2m149:24[22m[39m
[90m [2mâ¯[22m node_modules/@vitest/runner/dist/index.js:[2m145:11[22m[39m
[90m [2mâ¯[22m node_modules/@vitest/runner/dist/index.js:[2m919:26[22m[39m
[90m [2mâ¯[22m node_modules/@vitest/runner/dist/index.js:[2m1244:20[22m[39m
[90m [2mâ¯[22m runWithTimeout node_modules/@vitest/runner/dist/index.js:[2m1210:10[22m[39m

[31mThis error originated in "[1msrc/utils/stringExtractor.test.ts[22m" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.[39m
[31mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[39m


[2m Test Files [22m [1m[32m37 passed[39m[22m[90m (37)[39m
[2m      Tests [22m [1m[32m252 passed[39m[22m[90m (252)[39m
[2m     Errors [22m [1m[31m1 error[39m[22m
[2m   Start at [22m 20:59:09
[2m   Duration [22m 3.39s[2m (transform 1.42s, setup 2.19s, import 4.30s, tests 6.11s, environment 12.34s)[22m

