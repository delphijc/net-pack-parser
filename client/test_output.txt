
> client@0.0.0 test
> vitest run


 RUN  v4.0.14 /home/jaysoncavendish/Projects/net-pack-parser/client

 â¯ src/components/ThreatPanel.test.tsx (7 tests | 3 failed) 3103ms
     âœ“ renders "No threats detected." when no threats are provided  329ms
     Ã— renders a list of threats when provided 430ms
     Ã— calls onThreatClick when a threat item is clicked 72ms
     âœ“ calls onUpdateThreatStatus with "falsePositive" when "Mark as False Positive" button is clicked  1495ms
     Ã— calls onUpdateThreatStatus with "confirmed" when "Mark as Confirmed" button is clicked 327ms
     âœ“ disables "Mark as False Positive" button if threat is already falsePositive 272ms
     âœ“ disables "Mark as Confirmed" button if threat is already confirmed 157ms
 â¯ src/utils/sqlInjectionDetector.test.ts (17 tests | 3 failed) 124ms
     âœ“ should return an empty array if no SQL injection is detected 8ms
     âœ“ should return an empty array if the packet is not HTTP(S) 1ms
     Ã— should detect classic SQL injection in GET query parameter (URL-encoded) 64ms
     âœ“ should detect classic SQL injection in POST body (URL-encoded) 4ms
     âœ“ should detect UNION SELECT (none encoded) 3ms
     âœ“ should detect URL-encoded SQL injection 6ms
     âœ“ should detect hex-encoded SQL injection 1ms
     âœ“ should detect doubly encoded SQL injection (URL then Hex) 4ms
     âœ“ should detect WAITFOR DELAY (none encoded) 1ms
     âœ“ should detect BENCHMARK (none encoded) 5ms
     âœ“ should detect boolean-based AND 1=1 (none encoded) 1ms
     Ã— should detect boolean-based OR 1=2 (none encoded) 7ms
     âœ“ should correctly identify matches within a larger string 1ms
     âœ“ should handle multiple unique threats in different fields of the payload 1ms
     âœ“ should detect SQLi in User-Agent header 0ms
     âœ“ should detect SQLi in Cookie header 0ms
     Ã— should handle multiple matches within the same field and encoding, aggregating matchDetails 2ms
 â¯ src/components/PacketDetailView.test.tsx (6 tests | 4 failed) 8031ms
     Ã— renders packet details correctly 1712ms
     âœ“ displays Hex Dump tab content by default  706ms
     âœ“ switches to Extracted Strings tab  660ms
     Ã— displays the Threats tab and its content 1496ms
     Ã— passes correct highlightRanges to HexDumpViewer for threats 1917ms
     Ã— does not pass threat highlightRanges if no threats are provided 1533ms
 â¯ src/utils/sqlInjectionPatterns.test.ts (18 tests | 2 failed) 89ms
       âœ“ should detect basic OR 1=1 8ms
       âœ“ should detect basic OR TRUE 4ms
       âœ“ should detect union select 1ms
       âœ“ should detect stacked queries with DROP TABLE 1ms
       âœ“ should detect comments 4ms
       âœ“ should detect SQL Server WAITFOR DELAY 1ms
       âœ“ should detect PostgreSQL PG_SLEEP 4ms
       âœ“ should detect MySQL SLEEP 1ms
       âœ“ should detect MySQL BENCHMARK 4ms
       âœ“ should detect AND 1=1 5ms
       Ã— should detect OR 1=2 32ms
       Ã— should detect AND TRUE/FALSE 5ms
     âœ“ should correctly decode URL-encoded strings 1ms
     âœ“ should handle already decoded strings 0ms
     âœ“ should handle invalid URL encoding gracefully 0ms
     âœ“ should correctly decode hex-encoded strings 6ms
     âœ“ should handle already decoded strings 0ms
     âœ“ should handle invalid hex encoding gracefully 0ms
 â¯ src/components/AdvancedSearchPanel.test.tsx (6 tests | 2 failed) 18374ms
     âœ“ renders all search fields correctly  3278ms
     Ã— allows entering criteria and submitting search 5070ms
     Ã— clears all fields when Clear All is clicked 905ms
     âœ“ saves a new search configuration  3635ms
     âœ“ loads a saved search  2097ms
     âœ“ deletes a saved search  3370ms
 âœ“ src/components/PacketList.integration.test.tsx (7 tests) 2080ms
     âœ“ should render PacketList, ProtocolFilter, and ProtocolDistributionChart  331ms
     âœ“ should update the ProtocolDistributionChart when packets change  380ms
     âœ“ should clear selected packet and close detail view when selected packet is deleted  472ms
 âœ“ src/components/SettingsPage.test.tsx (8 tests) 6256ms
     âœ“ renders the settings page with storage usage  589ms
     âœ“ shows a confirmation dialog when "Clear All Local Data" is clicked  1309ms
     âœ“ calls clearAll when confirmation is accepted  797ms
     âœ“ triggers export when "Export Data" is clicked  324ms
     âœ“ opens confirmation dialog when a file is selected for import  776ms
     âœ“ calls importDataFromJson with "merge" mode when Merge is clicked  863ms
     âœ“ calls importDataFromJson with "replace" mode when Replace is clicked  893ms
     âœ“ displays error toast when import fails  689ms
stderr | src/components/FileInfo.test.tsx > FileInfo > should display "Verification Error" on API failure
Error during integrity verification: Error: Test error
    at /home/jaysoncavendish/Projects/net-pack-parser/client/src/components/FileInfo.test.tsx:89:22
    at Mock (file:///home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/@vitest/spy/dist/index.js:280:34)
    at handleVerify (/home/jaysoncavendish/Projects/net-pack-parser/client/src/components/FileInfo.tsx:28:28)
    at executeDispatch (/home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/react-dom/cjs/react-dom-client.development.js:19116:9)
    at runWithFiberInDEV (/home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
    at processDispatchQueue (/home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/react-dom/cjs/react-dom-client.development.js:19166:19)
    at /home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/react-dom/cjs/react-dom-client.development.js:19767:9
    at batchedUpdates$1 (/home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/react-dom/cjs/react-dom-client.development.js:3255:40)
    at dispatchEventForPluginEventSystem (/home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/react-dom/cjs/react-dom-client.development.js:19320:7)
    at dispatchEvent (/home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/react-dom/cjs/react-dom-client.development.js:23585:11)

 âœ“ src/components/FileInfo.test.tsx (4 tests) 1955ms
     âœ“ should call onVerifyIntegrity when the button is clicked  1100ms
     âœ“ should display "Verification Error" on API failure  316ms
 âœ“ src/components/ExtractedStringsTab.test.tsx (6 tests) 3026ms
     âœ“ renders "No strings extracted" when list is empty  330ms
     âœ“ filters strings by type  655ms
     âœ“ sorts strings by column  1560ms
stderr | src/components/FilesTab.test.tsx > FilesTab > renders detected files
In HTML, whitespace text nodes cannot be a child of <tr>. Make sure you don't have any extra whitespace between tags on each line of your source code.
This will cause a hydration error.

  <FilesTab packet={{id:"packet-1", ...}}>
    <div className="p-4">
      <Table>
        <div className="relative w...">
          <table ref={null} className="w-full cap...">
            <TableCaption>
            <TableHeader>
            <TableBody>
              <tbody ref={null} className={"[&_tr:la..."}>
                <TableRow>
>                 <tr ref={null} className="border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted">
                    <TableCell>
                    <TableCell>
                    <TableCell>
                    <TableCell>
>                   {" "}
                    ...


stdout | src/components/FilesTab.test.tsx > FilesTab > handles file download
Downloaded file: test.txt, Hash: hash123
Chain of Custody event logged

stderr | src/components/FilesTab.test.tsx > FilesTab > displays message when no files detected
An update to FilesTab inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

Not implemented: navigation to another Document
 âœ“ src/components/FilesTab.test.tsx (3 tests) 553ms
     âœ“ renders detected files  351ms
stderr | src/components/parser/PcapUpload.test.tsx > PcapUpload Component > renders correctly
An update to ChainOfCustodyLog inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 âœ“ src/components/FilterBar.test.tsx (5 tests) 639ms
     âœ“ renders correctly  368ms
 âœ“ src/components/parser/PcapUpload.test.tsx (3 tests) 819ms
     âœ“ renders correctly  383ms
     âœ“ handles text input parsing  308ms
 âœ“ src/components/ProtocolFilter.test.tsx (5 tests) 291ms
 âœ“ src/services/localStorage.test.ts (7 tests) 160ms
 âœ“ src/utils/fileExtractor.test.ts (20 tests) 79ms
 âœ“ src/utils/stringExtractorCore.test.ts (13 tests) 96ms
 âœ“ src/utils/stringExtractor.test.ts (6 tests) 134ms
stderr | src/utils/dataImportExport.test.ts > dataImportExport > importDataFromJson > should fail if the file format is invalid
Import failed: Error: Invalid import file format: missing metadata or data section.
    at Module.importDataFromJson (/home/jaysoncavendish/Projects/net-pack-parser/client/src/utils/dataImportExport.ts:84:13)
    at /home/jaysoncavendish/Projects/net-pack-parser/client/src/utils/dataImportExport.test.ts:163:22
    at file:///home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/@vitest/runner/dist/index.js:919:26
    at file:///home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/@vitest/runner/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/@vitest/runner/dist/index.js:1210:10)
    at file:///home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/@vitest/runner/dist/index.js:1654:37
    at Traces.$ (file:///home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:115:27)
    at trace (file:///home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/vitest/dist/chunks/test.DqQZzsWf.js:234:21)

stderr | src/utils/dataImportExport.test.ts > dataImportExport > importDataFromJson > should fail if the schema version is different
Import failed: Error: Invalid schema version. Expected 1.0, but file is version 0.9.
    at Module.importDataFromJson (/home/jaysoncavendish/Projects/net-pack-parser/client/src/utils/dataImportExport.ts:91:13)
    at /home/jaysoncavendish/Projects/net-pack-parser/client/src/utils/dataImportExport.test.ts:180:22
    at file:///home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/@vitest/runner/dist/index.js:919:26
    at file:///home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/@vitest/runner/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/@vitest/runner/dist/index.js:1210:10)
    at file:///home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/@vitest/runner/dist/index.js:1654:37
    at Traces.$ (file:///home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:115:27)
    at trace (file:///home/jaysoncavendish/Projects/net-pack-parser/client/node_modules/vitest/dist/chunks/test.DqQZzsWf.js:234:21)

 âœ“ src/utils/dataImportExport.test.ts (5 tests) 100ms
 âœ“ src/utils/multiCriteriaSearch.test.ts (11 tests) 17ms
 âœ“ src/services/pcapParser.test.ts (3 tests) 38ms
 âœ“ src/utils/bpfFilter.test.ts (8 tests) 40ms
 âœ“ src/utils/protocolDetector.test.ts (17 tests) 42ms
 âœ“ src/components/HexDumpViewer.test.tsx (7 tests) 10ms
 âœ“ src/utils/hashGenerator.test.ts (4 tests) 9ms

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯ Failed Tests 14 âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯

 FAIL  src/components/AdvancedSearchPanel.test.tsx > AdvancedSearchPanel > allows entering criteria and submitting search
Error: Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
 â¯ src/components/AdvancedSearchPanel.test.tsx:90:3
     88|   });
     89| 
     90|   it('allows entering criteria and submitting search', async () => {
       |   ^
     91|     const user = userEvent.setup();
     92|     render(

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[1/14]âŽ¯

 FAIL  src/components/AdvancedSearchPanel.test.tsx > AdvancedSearchPanel > clears all fields when Clear All is clicked
Error: expect(element).toHaveValue(10.0.0.1)

Expected the element to have value:
  10.0.0.1
Received:
  1
 â¯ src/components/AdvancedSearchPanel.test.tsx:135:49
    133|     // Enter some data
    134|     await user.type(screen.getByLabelText(/Source IP/i), '10.0.0.1');
    135|     expect(screen.getByLabelText(/Source IP/i)).toHaveValue('10.0.0.1'â€¦
       |                                                 ^
    136| 
    137|     // Click Clear

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[2/14]âŽ¯

 FAIL  src/components/PacketDetailView.test.tsx > PacketDetailView > renders packet details correctly
TestingLibraryElementError: Unable to find an element with the text: /Source: 192.168.1.1/. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body[39m
  [33mdata-scroll-locked[39m=[32m"1"[39m
  [33mstyle[39m=[32m"pointer-events: none;"[39m
[36m>[39m
  [36m<span[39m
    [33maria-hidden[39m=[32m"true"[39m
    [33mdata-aria-hidden[39m=[32m"true"[39m
    [33mdata-radix-focus-guard[39m=[32m""[39m
    [33mstyle[39m=[32m"outline: none; opacity: 0; position: fixed; pointer-events: none;"[39m
    [33mtabindex[39m=[32m"0"[39m
  [36m/>[39m
  [36m<div[39m
    [33maria-hidden[39m=[32m"true"[39m
    [33mdata-aria-hidden[39m=[32m"true"[39m
  [36m/>[39m
  [36m<div[39m
    [33maria-hidden[39m=[32m"true"[39m
    [33mclass[39m=[32m"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"[39m
    [33mdata-aria-hidden[39m=[32m"true"[39m
    [33mdata-state[39m=[32m"open"[39m
    [33mstyle[39m=[32m"pointer-events: auto;"[39m
  [36m/>[39m
  [36m<div[39m
    [33maria-describedby[39m=[32m"radix-_r_2_"[39m
    [33maria-labelledby[39m=[32m"radix-_r_1_"[39m
    [33mclass[39m=[32m"fixed z-50 gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out inset-y-0 right-0 h-full data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right w-full max-w-2xl flex flex-col bg-background/95 backdrop-blur-md border-l border-white/10 p-0 sm:max-w-2xl"[39m
    [33mdata-state[39m=[32m"open"[39m
    [33mid[39m=[32m"radix-_r_0_"[39m
    [33mrole[39m=[32m"dialog"[39m
    [33mstyle[39m=[32m"pointer-events: auto;"[39m
    [33mtabindex[39m=[32m"-1"[39m
  [36m>[39m
    [36m<button[39m
      [33mclass[39m=[32m"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary"[39m
      [33mtype[39m=[32m"button"[39m
    [36m>[39m
      [36m<svg[39m
        [33maria-hidden[39m=[32m"true"[39m
        [33mclass[39m=[32m"lucide lucide-x h-4 w-4"[39m
        [33mfill[39m=[32m"none"[39m
        [33mheight[39m=[32m"24"[39m
        [33mstroke[39m=[32m"currentColor"[39m
        [33mstroke-linecap[39m=[32m"round"[39m
        [33mstroke-linejoin[39m=[32m"round"[39m
        [33mstroke-width[39m=[32m"2"[39m
        [33mviewBox[39m=[32m"0 0 24 24"[39m
        [33mwidth[39m=[32m"24"[39m
        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
      [36m>[39m
        [36m<path[39m
          [33md[39m=[32m"M18 6 6 18"[39m
        [36m/>[39m
        [36m<path[39m
          [33md[39m=[32m"m6 6 12 12"[39m
        [36m/>[39m
      [36m</svg>[39m
      [36m<span[39m
        [33mclass[39m=[32m"sr-only"[39m
      [36m>[39m
        [0mClose[0m
      [36m</span>[39m
    [36m</button>[39m
    [36m<div[39m
      [33mclass[39m=[32m"flex flex-col space-y-2 text-center sm:text-left p-6 border-b border-white/10"[39m
    [36m>[39m
      [36m<h2[39m
        [33mclass[39m=[32m"text-xl font-bold text-foreground flex items-center gap-2"[39m
        [33mid[39m=[32m"radix-_r_1_"[39m
      [36m>[39m
        [0mPacket Details[0m
        [36m<span[39m
          [33mclass[39m=[32m"text-sm font-normal text-muted-foreground font-mono bg-secondary px-2 py-0.5 rounded"[39m
        [36m>[39m
          [0mID: [0m
          [0mpacket-test-1[0m
        [36m</span>[39m
      [36m</h2>[39m
      [36m<p[39m
        [33mclass[39m=[32m"text-sm text-muted-foreground"[39m
        [33mid[39m=[32m"radix-_r_2_"[39m
      [36m>[39m
        [0mDetailed view of the selected network packet.[0m
      [36m</p>[39m
    [36m</div>[39m
    [36m<div[39m
      [33mclass[39m=[32m"flex-grow overflow-y-auto p-6 space-y-6"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"bg-card border border-white/10 p-4 rounded-lg shadow-sm"[39m
      [36m>[39m
        [36m<h3[39m
          [33mclass[39m=[32m"font-semibold text-sm text-foreground mb-3 flex items-center gap-2"[39m
        [36m>[39m
          [36m<span[39m
            [33mclass[39m=[32m"w-1 h-4 bg-primary rounded-full"[39m
          [36m/>[39m
          [0mSummary[0m
        [36m</h3>[39m
        [36m<div[39m
          [33mclass[39m=[32m"grid grid-cols-2 gap-4 text-sm"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"space-y-1"[39m
          [36m>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
            [36m>[39m
              [0mTimestamp[0m
            [36m</p>[39m
            [36m<p[39m
              [33mclass[39m=[32m"font-mono text-foreground"[39m
            [36m>[39m
              [0m11/30/2025, 12:04:25 PM[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"space-y-1"[39m
          [36m>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
            [36m>[39m
              [0mProtocol[0m
            [36m</p>[39m
            [36m<p[39m
              [33mclass[39m=[32m"font-mono text-foreground"[39m
            [36m>[39m
              [0mTCP[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"space-y-1"[39m
          [36m>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
            [36m>[39m
              [0mSource[0m
            [36m</p>[39m
            [36m<p[39m
              [33mclass[39m=[32m"font-mono text-foreground"[39m
            [36m>[39m
              [36m<span[39m
                [33mclass[39m=[32m""[39m
              [36m>[39m
                [0m192.168.1.1[0m
              [36m</span>[39m
              [36m<span[39m
                [33mclass[39m=[32m""[39m
              [36m>[39m
                [0m:12345[0m
              [36m</span>[39m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"space-y-1"[39m
          [36m>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
            [36m>[39m
              [0mDestination[0m
            [36m</p>[39m
            [36m<p[39m
              [33mclass[39m=[32m"font-mono text-foreground"[39m
            [36m>[39m
              [36m<span[39m
                [33mclass[39m=[32m""[39m
              [36m>[39m
                [0m192.168.1.100[0m
              [36m</span>[39m
              [36m<span[39m
       ...
 â¯ Object.getElementError node_modules/@testing-library/dom/dist/config.js:37:19
 â¯ node_modules/@testing-library/dom/dist/query-helpers.js:76:38
 â¯ node_modules/@testing-library/dom/dist/query-helpers.js:52:17
 â¯ node_modules/@testing-library/dom/dist/query-helpers.js:95:19
 â¯ src/components/PacketDetailView.test.tsx:78:19
     76|     expect(screen.getByText('Packet Details')).toBeInTheDocument();
     77|     expect(screen.getByText(/ID: packet-test-1/)).toBeInTheDocument();
     78|     expect(screen.getByText(/Source: 192.168.1.1/)).toBeInTheDocument(â€¦
       |                   ^
     79|   });
     80| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[3/14]âŽ¯

 FAIL  src/components/PacketDetailView.test.tsx > PacketDetailView > displays the Threats tab and its content
TestingLibraryElementError: Unable to find an element with the text: /Mock ThreatPanel (1 threats)/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body[39m
  [33mdata-scroll-locked[39m=[32m"1"[39m
  [33mstyle[39m=[32m"pointer-events: none;"[39m
[36m>[39m
  [36m<span[39m
    [33maria-hidden[39m=[32m"true"[39m
    [33mdata-aria-hidden[39m=[32m"true"[39m
    [33mdata-radix-focus-guard[39m=[32m""[39m
    [33mstyle[39m=[32m"outline: none; opacity: 0; position: fixed; pointer-events: none;"[39m
    [33mtabindex[39m=[32m"0"[39m
  [36m/>[39m
  [36m<div[39m
    [33maria-hidden[39m=[32m"true"[39m
    [33mdata-aria-hidden[39m=[32m"true"[39m
  [36m/>[39m
  [36m<div[39m
    [33maria-hidden[39m=[32m"true"[39m
    [33mclass[39m=[32m"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"[39m
    [33mdata-aria-hidden[39m=[32m"true"[39m
    [33mdata-state[39m=[32m"open"[39m
    [33mstyle[39m=[32m"pointer-events: auto;"[39m
  [36m/>[39m
  [36m<div[39m
    [33maria-describedby[39m=[32m"radix-_r_q_"[39m
    [33maria-labelledby[39m=[32m"radix-_r_p_"[39m
    [33mclass[39m=[32m"fixed z-50 gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out inset-y-0 right-0 h-full data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right w-full max-w-2xl flex flex-col bg-background/95 backdrop-blur-md border-l border-white/10 p-0 sm:max-w-2xl"[39m
    [33mdata-state[39m=[32m"open"[39m
    [33mid[39m=[32m"radix-_r_o_"[39m
    [33mrole[39m=[32m"dialog"[39m
    [33mstyle[39m=[32m"pointer-events: auto;"[39m
    [33mtabindex[39m=[32m"-1"[39m
  [36m>[39m
    [36m<button[39m
      [33mclass[39m=[32m"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary"[39m
      [33mtype[39m=[32m"button"[39m
    [36m>[39m
      [36m<svg[39m
        [33maria-hidden[39m=[32m"true"[39m
        [33mclass[39m=[32m"lucide lucide-x h-4 w-4"[39m
        [33mfill[39m=[32m"none"[39m
        [33mheight[39m=[32m"24"[39m
        [33mstroke[39m=[32m"currentColor"[39m
        [33mstroke-linecap[39m=[32m"round"[39m
        [33mstroke-linejoin[39m=[32m"round"[39m
        [33mstroke-width[39m=[32m"2"[39m
        [33mviewBox[39m=[32m"0 0 24 24"[39m
        [33mwidth[39m=[32m"24"[39m
        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
      [36m>[39m
        [36m<path[39m
          [33md[39m=[32m"M18 6 6 18"[39m
        [36m/>[39m
        [36m<path[39m
          [33md[39m=[32m"m6 6 12 12"[39m
        [36m/>[39m
      [36m</svg>[39m
      [36m<span[39m
        [33mclass[39m=[32m"sr-only"[39m
      [36m>[39m
        [0mClose[0m
      [36m</span>[39m
    [36m</button>[39m
    [36m<div[39m
      [33mclass[39m=[32m"flex flex-col space-y-2 text-center sm:text-left p-6 border-b border-white/10"[39m
    [36m>[39m
      [36m<h2[39m
        [33mclass[39m=[32m"text-xl font-bold text-foreground flex items-center gap-2"[39m
        [33mid[39m=[32m"radix-_r_p_"[39m
      [36m>[39m
        [0mPacket Details[0m
        [36m<span[39m
          [33mclass[39m=[32m"text-sm font-normal text-muted-foreground font-mono bg-secondary px-2 py-0.5 rounded"[39m
        [36m>[39m
          [0mID: [0m
          [0mpacket-test-1[0m
        [36m</span>[39m
      [36m</h2>[39m
      [36m<p[39m
        [33mclass[39m=[32m"text-sm text-muted-foreground"[39m
        [33mid[39m=[32m"radix-_r_q_"[39m
      [36m>[39m
        [0mDetailed view of the selected network packet.[0m
      [36m</p>[39m
    [36m</div>[39m
    [36m<div[39m
      [33mclass[39m=[32m"flex-grow overflow-y-auto p-6 space-y-6"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"bg-card border border-white/10 p-4 rounded-lg shadow-sm"[39m
      [36m>[39m
        [36m<h3[39m
          [33mclass[39m=[32m"font-semibold text-sm text-foreground mb-3 flex items-center gap-2"[39m
        [36m>[39m
          [36m<span[39m
            [33mclass[39m=[32m"w-1 h-4 bg-primary rounded-full"[39m
          [36m/>[39m
          [0mSummary[0m
        [36m</h3>[39m
        [36m<div[39m
          [33mclass[39m=[32m"grid grid-cols-2 gap-4 text-sm"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"space-y-1"[39m
          [36m>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
            [36m>[39m
              [0mTimestamp[0m
            [36m</p>[39m
            [36m<p[39m
              [33mclass[39m=[32m"font-mono text-foreground"[39m
            [36m>[39m
              [0m11/30/2025, 12:04:25 PM[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"space-y-1"[39m
          [36m>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
            [36m>[39m
              [0mProtocol[0m
            [36m</p>[39m
            [36m<p[39m
              [33mclass[39m=[32m"font-mono text-foreground"[39m
            [36m>[39m
              [0mTCP[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"space-y-1"[39m
          [36m>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
            [36m>[39m
              [0mSource[0m
            [36m</p>[39m
            [36m<p[39m
              [33mclass[39m=[32m"font-mono text-foreground"[39m
            [36m>[39m
              [36m<span[39m
                [33mclass[39m=[32m""[39m
              [36m>[39m
                [0m192.168.1.1[0m
              [36m</span>[39m
              [36m<span[39m
                [33mclass[39m=[32m""[39m
              [36m>[39m
                [0m:12345[0m
              [36m</span>[39m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"space-y-1"[39m
          [36m>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
            [36m>[39m
              [0mDestination[0m
            [36m</p>[39m
            [36m<p[39m
              [33mclass[39m=[32m"font-mono text-foreground"[39m
            [36m>[39m
              [36m<span[39m
                [33mclass[39m=[32m""[39m
              [36m>[39m
                [0m192.168.1.100[0m
              [36m</span>[39m
              [36m<span[39m
       ...

Ignored nodes: comments, script, style
[36m<html>[39m
  [36m<head />[39m
  [36m<body[39m
    [33mdata-scroll-locked[39m=[32m"1"[39m
    [33mstyle[39m=[32m"pointer-events: none;"[39m
  [36m>[39m
    [36m<span[39m
      [33maria-hidden[39m=[32m"true"[39m
      [33mdata-aria-hidden[39m=[32m"true"[39m
      [33mdata-radix-focus-guard[39m=[32m""[39m
      [33mstyle[39m=[32m"outline: none; opacity: 0; position: fixed; pointer-events: none;"[39m
      [33mtabindex[39m=[32m"0"[39m
    [36m/>[39m
    [36m<div[39m
      [33maria-hidden[39m=[32m"true"[39m
      [33mdata-aria-hidden[39m=[32m"true"[39m
    [36m/>[39m
    [36m<div[39m
      [33maria-hidden[39m=[32m"true"[39m
      [33mclass[39m=[32m"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"[39m
      [33mdata-aria-hidden[39m=[32m"true"[39m
      [33mdata-state[39m=[32m"open"[39m
      [33mstyle[39m=[32m"pointer-events: auto;"[39m
    [36m/>[39m
    [36m<div[39m
      [33maria-describedby[39m=[32m"radix-_r_q_"[39m
      [33maria-labelledby[39m=[32m"radix-_r_p_"[39m
      [33mclass[39m=[32m"fixed z-50 gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out inset-y-0 right-0 h-full data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right w-full max-w-2xl flex flex-col bg-background/95 backdrop-blur-md border-l border-white/10 p-0 sm:max-w-2xl"[39m
      [33mdata-state[39m=[32m"open"[39m
      [33mid[39m=[32m"radix-_r_o_"[39m
      [33mrole[39m=[32m"dialog"[39m
      [33mstyle[39m=[32m"pointer-events: auto;"[39m
      [33mtabindex[39m=[32m"-1"[39m
    [36m>[39m
      [36m<button[39m
        [33mclass[39m=[32m"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary"[39m
        [33mtype[39m=[32m"button"[39m
      [36m>[39m
        [36m<svg[39m
          [33maria-hidden[39m=[32m"true"[39m
          [33mclass[39m=[32m"lucide lucide-x h-4 w-4"[39m
          [33mfill[39m=[32m"none"[39m
          [33mheight[39m=[32m"24"[39m
          [33mstroke[39m=[32m"currentColor"[39m
          [33mstroke-linecap[39m=[32m"round"[39m
          [33mstroke-linejoin[39m=[32m"round"[39m
          [33mstroke-width[39m=[32m"2"[39m
          [33mviewBox[39m=[32m"0 0 24 24"[39m
          [33mwidth[39m=[32m"24"[39m
          [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
        [36m>[39m
          [36m<path[39m
            [33md[39m=[32m"M18 6 6 18"[39m
          [36m/>[39m
          [36m<path[39m
            [33md[39m=[32m"m6 6 12 12"[39m
          [36m/>[39m
        [36m</svg>[39m
        [36m<span[39m
          [33mclass[39m=[32m"sr-only"[39m
        [36m>[39m
          [0mClose[0m
        [36m</span>[39m
      [36m</button>[39m
      [36m<div[39m
        [33mclass[39m=[32m"flex flex-col space-y-2 text-center sm:text-left p-6 border-b border-white/10"[39m
      [36m>[39m
        [36m<h2[39m
          [33mclass[39m=[32m"text-xl font-bold text-foreground flex items-center gap-2"[39m
          [33mid[39m=[32m"radix-_r_p_"[39m
        [36m>[39m
          [0mPacket Details[0m
          [36m<span[39m
            [33mclass[39m=[32m"text-sm font-normal text-muted-foreground font-mono bg-secondary px-2 py-0.5 rounded"[39m
          [36m>[39m
            [0mID: [0m
            [0mpacket-test-1[0m
          [36m</span>[39m
        [36m</h2>[39m
        [36m<p[39m
          [33mclass[39m=[32m"text-sm text-muted-foreground"[39m
          [33mid[39m=[32m"radix-_r_q_"[39m
        [36m>[39m
          [0mDetailed view of the selected network packet.[0m
        [36m</p>[39m
      [36m</div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"flex-grow overflow-y-auto p-6 space-y-6"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-card border border-white/10 p-4 rounded-lg shadow-sm"[39m
        [36m>[39m
          [36m<h3[39m
            [33mclass[39m=[32m"font-semibold text-sm text-foreground mb-3 flex items-center gap-2"[39m
          [36m>[39m
            [36m<span[39m
              [33mclass[39m=[32m"w-1 h-4 bg-primary rounded-full"[39m
            [36m/>[39m
            [0mSummary[0m
          [36m</h3>[39m
          [36m<div[39m
            [33mclass[39m=[32m"grid grid-cols-2 gap-4 text-sm"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-1"[39m
            [36m>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
              [36m>[39m
                [0mTimestamp[0m
              [36m</p>[39m
              [36m<p[39m
                [33mclass[39m=[32m"font-mono text-foreground"[39m
              [36m>[39m
                [0m11/30/2025, 12:04:25 PM[0m
              [36m</p>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-1"[39m
            [36m>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
              [36m>[39m
                [0mProtocol[0m
              [36m</p>[39m
              [36m<p[39m
                [33mclass[39m=[32m"font-mono text-foreground"[39m
              [36m>[39m
                [0mTCP[0m
              [36m</p>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-1"[39m
            [36m>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
              [36m>[39m
                [0mSource[0m
              [36m</p>[39m
              [36m<p[39m
                [33mclass[39m=[32m"font-mono text-foreground"[39m
              [36m>[39m
                [36m<span[39m
                  [33mclass[39m=[32m""[39m
                [36m>[39m
                  [0m192.168.1.1[0m
                [36m</span>[39m
                [36m<span[39m
                  [33mclass[39m=[32m""[39m
                [36m>[39m
                  [0m:12345[0m
                [36m</span>[39m
              [36m</p>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-1"[39m
            [36m>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
              [36m>[39m
                [0mDestination...
 â¯ Proxy.waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 â¯ src/components/PacketDetailView.test.tsx:121:11
    119|     fireEvent.click(screen.getByRole('tab', { name: /Threats/i }));
    120| 
    121|     await waitFor(() => {
       |           ^
    122|       expect(
    123|         screen.getByText(/Mock ThreatPanel (1 threats)/i),

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[4/14]âŽ¯

 FAIL  src/components/PacketDetailView.test.tsx > PacketDetailView > passes correct highlightRanges to HexDumpViewer for threats
AssertionError: expected "vi.fn()" to be called with arguments: [ ObjectContaining{â€¦}, {} ]

Received: 

  1st vi.fn() call:

  [
-   ObjectContaining {
-     "highlightRanges": ArrayContaining [
    {
-         "length": 5,
-         "offset": 10,
+     "caseSensitive": false,
+     "highlightRanges": [],
+     "rawData": ArrayBuffer [],
+     "searchString": null,
    },
-     ],
-   },
-   {},
+   undefined,
  ]

  2nd vi.fn() call:

  [
-   ObjectContaining {
-     "highlightRanges": ArrayContaining [
    {
-         "length": 5,
-         "offset": 10,
+     "caseSensitive": false,
+     "highlightRanges": [],
+     "rawData": ArrayBuffer [],
+     "searchString": null,
    },
-     ],
-   },
-   {},
+   undefined,
  ]

  3rd vi.fn() call:

  [
-   ObjectContaining {
-     "highlightRanges": ArrayContaining [
    {
-         "length": 5,
-         "offset": 10,
+     "caseSensitive": false,
+     "highlightRanges": [],
+     "rawData": ArrayBuffer [],
+     "searchString": null,
    },
-     ],
-   },
-   {},
+   undefined,
  ]

  4th vi.fn() call:

  [
-   ObjectContaining {
-     "highlightRanges": ArrayContaining [
    {
+     "caseSensitive": false,
+     "highlightRanges": [
+       {
          "length": 5,
          "offset": 10,
        },
      ],
+     "rawData": ArrayBuffer [],
+     "searchString": null,
    },
-   {},
+   undefined,
  ]

  5th vi.fn() call:

  [
-   ObjectContaining {
-     "highlightRanges": ArrayContaining [
    {
+     "caseSensitive": false,
+     "highlightRanges": [
+       {
          "length": 5,
          "offset": 10,
        },
      ],
+     "rawData": ArrayBuffer [],
+     "searchString": null,
    },
-   {},
+   undefined,
  ]


Number of calls: 5


Ignored nodes: comments, script, style
[36m<html>[39m
  [36m<head />[39m
  [36m<body[39m
    [33mdata-scroll-locked[39m=[32m"1"[39m
    [33mstyle[39m=[32m"pointer-events: none;"[39m
  [36m>[39m
    [36m<span[39m
      [33maria-hidden[39m=[32m"true"[39m
      [33mdata-aria-hidden[39m=[32m"true"[39m
      [33mdata-radix-focus-guard[39m=[32m""[39m
      [33mstyle[39m=[32m"outline: none; opacity: 0; position: fixed; pointer-events: none;"[39m
      [33mtabindex[39m=[32m"0"[39m
    [36m/>[39m
    [36m<div[39m
      [33maria-hidden[39m=[32m"true"[39m
      [33mdata-aria-hidden[39m=[32m"true"[39m
    [36m/>[39m
    [36m<div[39m
      [33maria-hidden[39m=[32m"true"[39m
      [33mclass[39m=[32m"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"[39m
      [33mdata-aria-hidden[39m=[32m"true"[39m
      [33mdata-state[39m=[32m"open"[39m
      [33mstyle[39m=[32m"pointer-events: auto;"[39m
    [36m/>[39m
    [36m<div[39m
      [33maria-describedby[39m=[32m"radix-_r_12_"[39m
      [33maria-labelledby[39m=[32m"radix-_r_11_"[39m
      [33mclass[39m=[32m"fixed z-50 gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out inset-y-0 right-0 h-full data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right w-full max-w-2xl flex flex-col bg-background/95 backdrop-blur-md border-l border-white/10 p-0 sm:max-w-2xl"[39m
      [33mdata-state[39m=[32m"open"[39m
      [33mid[39m=[32m"radix-_r_10_"[39m
      [33mrole[39m=[32m"dialog"[39m
      [33mstyle[39m=[32m"pointer-events: auto;"[39m
      [33mtabindex[39m=[32m"-1"[39m
    [36m>[39m
      [36m<button[39m
        [33mclass[39m=[32m"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary"[39m
        [33mtype[39m=[32m"button"[39m
      [36m>[39m
        [36m<svg[39m
          [33maria-hidden[39m=[32m"true"[39m
          [33mclass[39m=[32m"lucide lucide-x h-4 w-4"[39m
          [33mfill[39m=[32m"none"[39m
          [33mheight[39m=[32m"24"[39m
          [33mstroke[39m=[32m"currentColor"[39m
          [33mstroke-linecap[39m=[32m"round"[39m
          [33mstroke-linejoin[39m=[32m"round"[39m
          [33mstroke-width[39m=[32m"2"[39m
          [33mviewBox[39m=[32m"0 0 24 24"[39m
          [33mwidth[39m=[32m"24"[39m
          [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
        [36m>[39m
          [36m<path[39m
            [33md[39m=[32m"M18 6 6 18"[39m
          [36m/>[39m
          [36m<path[39m
            [33md[39m=[32m"m6 6 12 12"[39m
          [36m/>[39m
        [36m</svg>[39m
        [36m<span[39m
          [33mclass[39m=[32m"sr-only"[39m
        [36m>[39m
          [0mClose[0m
        [36m</span>[39m
      [36m</button>[39m
      [36m<div[39m
        [33mclass[39m=[32m"flex flex-col space-y-2 text-center sm:text-left p-6 border-b border-white/10"[39m
      [36m>[39m
        [36m<h2[39m
          [33mclass[39m=[32m"text-xl font-bold text-foreground flex items-center gap-2"[39m
          [33mid[39m=[32m"radix-_r_11_"[39m
        [36m>[39m
          [0mPacket Details[0m
          [36m<span[39m
            [33mclass[39m=[32m"text-sm font-normal text-muted-foreground font-mono bg-secondary px-2 py-0.5 rounded"[39m
          [36m>[39m
            [0mID: [0m
            [0mpacket-test-1[0m
          [36m</span>[39m
        [36m</h2>[39m
        [36m<p[39m
          [33mclass[39m=[32m"text-sm text-muted-foreground"[39m
          [33mid[39m=[32m"radix-_r_12_"[39m
        [36m>[39m
          [0mDetailed view of the selected network packet.[0m
        [36m</p>[39m
      [36m</div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"flex-grow overflow-y-auto p-6 space-y-6"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-card border border-white/10 p-4 rounded-lg shadow-sm"[39m
        [36m>[39m
          [36m<h3[39m
            [33mclass[39m=[32m"font-semibold text-sm text-foreground mb-3 flex items-center gap-2"[39m
          [36m>[39m
            [36m<span[39m
              [33mclass[39m=[32m"w-1 h-4 bg-primary rounded-full"[39m
            [36m/>[39m
            [0mSummary[0m
          [36m</h3>[39m
          [36m<div[39m
            [33mclass[39m=[32m"grid grid-cols-2 gap-4 text-sm"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-1"[39m
            [36m>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
              [36m>[39m
                [0mTimestamp[0m
              [36m</p>[39m
              [36m<p[39m
                [33mclass[39m=[32m"font-mono text-foreground"[39m
              [36m>[39m
                [0m11/30/2025, 12:04:25 PM[0m
              [36m</p>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-1"[39m
            [36m>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
              [36m>[39m
                [0mProtocol[0m
              [36m</p>[39m
              [36m<p[39m
                [33mclass[39m=[32m"font-mono text-foreground"[39m
              [36m>[39m
                [0mTCP[0m
              [36m</p>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-1"[39m
            [36m>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
              [36m>[39m
                [0mSource[0m
              [36m</p>[39m
              [36m<p[39m
                [33mclass[39m=[32m"font-mono text-foreground"[39m
              [36m>[39m
                [36m<span[39m
                  [33mclass[39m=[32m""[39m
                [36m>[39m
                  [0m192.168.1.1[0m
                [36m</span>[39m
                [36m<span[39m
                  [33mclass[39m=[32m""[39m
                [36m>[39m
                  [0m:12345[0m
                [36m</span>[39m
              [36m</p>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-1"[39m
            [36m>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
              [36m>[39m
                [0mDestina...
 â¯ src/components/PacketDetailView.test.tsx:146:29
    144| 
    145|     await waitFor(() => {
    146|       expect(HexDumpViewer).toHaveBeenCalledWith(
       |                             ^
    147|         expect.objectContaining({
    148|           highlightRanges: expect.arrayContaining([
 â¯ runWithExpensiveErrorDiagnosticsDisabled node_modules/@testing-library/dom/dist/config.js:47:12
 â¯ checkCallback node_modules/@testing-library/dom/dist/wait-for.js:124:77
 â¯ Timeout.checkRealTimersCallback node_modules/@testing-library/dom/dist/wait-for.js:118:16

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[5/14]âŽ¯

 FAIL  src/components/PacketDetailView.test.tsx > PacketDetailView > does not pass threat highlightRanges if no threats are provided
AssertionError: expected "vi.fn()" to be called with arguments: [ ObjectContaining{â€¦}, {} ]

Received: 

  1st vi.fn() call:

  [
-   ObjectContaining {
+   {
+     "caseSensitive": false,
      "highlightRanges": [],
+     "rawData": ArrayBuffer [],
+     "searchString": null,
    },
-   {},
+   undefined,
  ]

  2nd vi.fn() call:

  [
-   ObjectContaining {
+   {
+     "caseSensitive": false,
      "highlightRanges": [],
+     "rawData": ArrayBuffer [],
+     "searchString": null,
    },
-   {},
+   undefined,
  ]

  3rd vi.fn() call:

  [
-   ObjectContaining {
+   {
+     "caseSensitive": false,
      "highlightRanges": [],
+     "rawData": ArrayBuffer [],
+     "searchString": null,
    },
-   {},
+   undefined,
  ]

  4th vi.fn() call:

  [
-   ObjectContaining {
-     "highlightRanges": [],
+   {
+     "caseSensitive": false,
+     "highlightRanges": [
+       {
+         "length": 5,
+         "offset": 10,
        },
-   {},
+     ],
+     "rawData": ArrayBuffer [],
+     "searchString": null,
+   },
+   undefined,
  ]

  5th vi.fn() call:

  [
-   ObjectContaining {
-     "highlightRanges": [],
+   {
+     "caseSensitive": false,
+     "highlightRanges": [
+       {
+         "length": 5,
+         "offset": 10,
        },
-   {},
+     ],
+     "rawData": ArrayBuffer [],
+     "searchString": null,
+   },
+   undefined,
  ]

  6th vi.fn() call:

  [
-   ObjectContaining {
+   {
+     "caseSensitive": false,
      "highlightRanges": [],
+     "rawData": ArrayBuffer [],
+     "searchString": null,
    },
-   {},
+   undefined,
  ]


Number of calls: 6


Ignored nodes: comments, script, style
[36m<html>[39m
  [36m<head />[39m
  [36m<body[39m
    [33mdata-scroll-locked[39m=[32m"1"[39m
    [33mstyle[39m=[32m"pointer-events: none;"[39m
  [36m>[39m
    [36m<span[39m
      [33maria-hidden[39m=[32m"true"[39m
      [33mdata-aria-hidden[39m=[32m"true"[39m
      [33mdata-radix-focus-guard[39m=[32m""[39m
      [33mstyle[39m=[32m"outline: none; opacity: 0; position: fixed; pointer-events: none;"[39m
      [33mtabindex[39m=[32m"0"[39m
    [36m/>[39m
    [36m<div[39m
      [33maria-hidden[39m=[32m"true"[39m
      [33mdata-aria-hidden[39m=[32m"true"[39m
    [36m/>[39m
    [36m<div[39m
      [33maria-hidden[39m=[32m"true"[39m
      [33mclass[39m=[32m"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"[39m
      [33mdata-aria-hidden[39m=[32m"true"[39m
      [33mdata-state[39m=[32m"open"[39m
      [33mstyle[39m=[32m"pointer-events: auto;"[39m
    [36m/>[39m
    [36m<div[39m
      [33maria-describedby[39m=[32m"radix-_r_1a_"[39m
      [33maria-labelledby[39m=[32m"radix-_r_19_"[39m
      [33mclass[39m=[32m"fixed z-50 gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out inset-y-0 right-0 h-full data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right w-full max-w-2xl flex flex-col bg-background/95 backdrop-blur-md border-l border-white/10 p-0 sm:max-w-2xl"[39m
      [33mdata-state[39m=[32m"open"[39m
      [33mid[39m=[32m"radix-_r_18_"[39m
      [33mrole[39m=[32m"dialog"[39m
      [33mstyle[39m=[32m"pointer-events: auto;"[39m
      [33mtabindex[39m=[32m"-1"[39m
    [36m>[39m
      [36m<button[39m
        [33mclass[39m=[32m"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary"[39m
        [33mtype[39m=[32m"button"[39m
      [36m>[39m
        [36m<svg[39m
          [33maria-hidden[39m=[32m"true"[39m
          [33mclass[39m=[32m"lucide lucide-x h-4 w-4"[39m
          [33mfill[39m=[32m"none"[39m
          [33mheight[39m=[32m"24"[39m
          [33mstroke[39m=[32m"currentColor"[39m
          [33mstroke-linecap[39m=[32m"round"[39m
          [33mstroke-linejoin[39m=[32m"round"[39m
          [33mstroke-width[39m=[32m"2"[39m
          [33mviewBox[39m=[32m"0 0 24 24"[39m
          [33mwidth[39m=[32m"24"[39m
          [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
        [36m>[39m
          [36m<path[39m
            [33md[39m=[32m"M18 6 6 18"[39m
          [36m/>[39m
          [36m<path[39m
            [33md[39m=[32m"m6 6 12 12"[39m
          [36m/>[39m
        [36m</svg>[39m
        [36m<span[39m
          [33mclass[39m=[32m"sr-only"[39m
        [36m>[39m
          [0mClose[0m
        [36m</span>[39m
      [36m</button>[39m
      [36m<div[39m
        [33mclass[39m=[32m"flex flex-col space-y-2 text-center sm:text-left p-6 border-b border-white/10"[39m
      [36m>[39m
        [36m<h2[39m
          [33mclass[39m=[32m"text-xl font-bold text-foreground flex items-center gap-2"[39m
          [33mid[39m=[32m"radix-_r_19_"[39m
        [36m>[39m
          [0mPacket Details[0m
          [36m<span[39m
            [33mclass[39m=[32m"text-sm font-normal text-muted-foreground font-mono bg-secondary px-2 py-0.5 rounded"[39m
          [36m>[39m
            [0mID: [0m
            [0mpacket-test-1[0m
          [36m</span>[39m
        [36m</h2>[39m
        [36m<p[39m
          [33mclass[39m=[32m"text-sm text-muted-foreground"[39m
          [33mid[39m=[32m"radix-_r_1a_"[39m
        [36m>[39m
          [0mDetailed view of the selected network packet.[0m
        [36m</p>[39m
      [36m</div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"flex-grow overflow-y-auto p-6 space-y-6"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-card border border-white/10 p-4 rounded-lg shadow-sm"[39m
        [36m>[39m
          [36m<h3[39m
            [33mclass[39m=[32m"font-semibold text-sm text-foreground mb-3 flex items-center gap-2"[39m
          [36m>[39m
            [36m<span[39m
              [33mclass[39m=[32m"w-1 h-4 bg-primary rounded-full"[39m
            [36m/>[39m
            [0mSummary[0m
          [36m</h3>[39m
          [36m<div[39m
            [33mclass[39m=[32m"grid grid-cols-2 gap-4 text-sm"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-1"[39m
            [36m>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
              [36m>[39m
                [0mTimestamp[0m
              [36m</p>[39m
              [36m<p[39m
                [33mclass[39m=[32m"font-mono text-foreground"[39m
              [36m>[39m
                [0m11/30/2025, 12:04:25 PM[0m
              [36m</p>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-1"[39m
            [36m>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
              [36m>[39m
                [0mProtocol[0m
              [36m</p>[39m
              [36m<p[39m
                [33mclass[39m=[32m"font-mono text-foreground"[39m
              [36m>[39m
                [0mTCP[0m
              [36m</p>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-1"[39m
            [36m>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
              [36m>[39m
                [0mSource[0m
              [36m</p>[39m
              [36m<p[39m
                [33mclass[39m=[32m"font-mono text-foreground"[39m
              [36m>[39m
                [36m<span[39m
                  [33mclass[39m=[32m""[39m
                [36m>[39m
                  [0m192.168.1.1[0m
                [36m</span>[39m
                [36m<span[39m
                  [33mclass[39m=[32m""[39m
                [36m>[39m
                  [0m:12345[0m
                [36m</span>[39m
              [36m</p>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-1"[39m
            [36m>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-muted-foreground text-xs uppercase tracking-wider"[39m
              [36m>[39m
                [0mDestina...
 â¯ src/components/PacketDetailView.test.tsx:171:29
    169| 
    170|     await waitFor(() => {
    171|       expect(HexDumpViewer).toHaveBeenCalledWith(
       |                             ^
    172|         expect.objectContaining({
    173|           highlightRanges: [], // Should be empty without threats
 â¯ runWithExpensiveErrorDiagnosticsDisabled node_modules/@testing-library/dom/dist/config.js:47:12
 â¯ checkCallback node_modules/@testing-library/dom/dist/wait-for.js:124:77
 â¯ Timeout.checkRealTimersCallback node_modules/@testing-library/dom/dist/wait-for.js:118:16

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[6/14]âŽ¯

 FAIL  src/components/ThreatPanel.test.tsx > ThreatPanel > renders a list of threats when provided
TestingLibraryElementError: Found multiple elements with the text: /SQL Injection \(critical\)/i

Here are the matching elements:

Ignored nodes: comments, script, style
[36m<span[39m
  [33mclass[39m=[32m"font-medium text-red-700"[39m
[36m>[39m
  [0mSQL Injection[0m
  [0m ([0m
  [0mcritical[0m
  [0m)[0m
[36m</span>[39m

Ignored nodes: comments, script, style
[36m<span[39m
  [33mclass[39m=[32m"font-medium text-red-700"[39m
[36m>[39m
  [0mSQL Injection[0m
  [0m ([0m
  [0mcritical[0m
  [0m)[0m
[36m</span>[39m

(If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<div[39m
      [33mclass[39m=[32m"threat-panel p-4 border rounded-lg shadow-md bg-white"[39m
    [36m>[39m
      [36m<h2[39m
        [33mclass[39m=[32m"text-lg font-semibold mb-4"[39m
      [36m>[39m
        [0mDetected Threats[0m
      [36m</h2>[39m
      [36m<ul[39m
        [33mclass[39m=[32m"space-y-2"[39m
      [36m>[39m
        [36m<li[39m
          [33mclass[39m=[32m"p-3 border rounded-md bg-red-50 hover:bg-red-100"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"cursor-pointer"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex justify-between items-center"[39m
            [36m>[39m
              [36m<span[39m
                [33mclass[39m=[32m"font-medium text-red-700"[39m
              [36m>[39m
                [0mSQL Injection[0m
                [0m ([0m
                [0mcritical[0m
                [0m)[0m
              [36m</span>[39m
              [36m<span[39m
                [33mclass[39m=[32m"text-sm text-gray-500"[39m
              [36m>[39m
                [0m3/15/2023, 9:20:00 AM[0m
              [36m</span>[39m
            [36m</div>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-sm text-red-600 mt-1"[39m
            [36m>[39m
              [0mPotential SQL Injection detected in HTTP request (encoding: none)[0m
            [36m</p>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-xs text-gray-400 mt-1"[39m
            [36m>[39m
              [0mMITRE ATT&CK: [0m
              [0mT1190[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex justify-end gap-2 mt-2"[39m
          [36m>[39m
            [36m<button[39m
              [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground h-8 rounded-md px-3 text-xs"[39m
            [36m>[39m
              [0mMark as False Positive[0m
            [36m</button>[39m
            [36m<button[39m
              [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 bg-primary text-primary-foreground shadow hover:bg-primary/90 h-8 rounded-md px-3 text-xs"[39m
            [36m>[39m
              [0mMark as Confirmed[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</li>[39m
        [36m<li[39m
          [33mclass[39m=[32m"p-3 border rounded-md bg-red-50 hover:bg-red-100"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"cursor-pointer"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex justify-between items-center"[39m
            [36m>[39m
              [36m<span[39m
                [33mclass[39m=[32m"font-medium text-red-700"[39m
              [36m>[39m
                [0mSQL Injection[0m
                [0m ([0m
                [0mcritical[0m
                [0m)[0m
              [36m</span>[39m
              [36m<span[39m
                [33mclass[39m=[32m"text-sm text-gray-500"[39m
              [36m>[39m
                [0m3/15/2023, 9:21:00 AM[0m
              [36m</span>[39m
            [36m</div>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-sm text-red-600 mt-1"[39m
            [36m>[39m
              [0mPotential SQL Injection detected in HTTP request (encoding: url)[0m
            [36m</p>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-xs text-gray-400 mt-1"[39m
            [36m>[39m
              [0mMITRE ATT&CK: [0m
              [0mT1190[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex justify-end gap-2 mt-2"[39m
          [36m>[39m
            [36m<button[39m
              [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground h-8 rounded-md px-3 text-xs"[39m
              [33mdisabled[39m=[32m""[39m
            [36m>[39m
              [0mFalse Positive (Marked)[0m
            [36m</button>[39m
            [36m<button[39m
              [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 bg-primary text-primary-foreground shadow hover:bg-primary/90 h-8 rounded-md px-3 text-xs"[39m
            [36m>[39m
              [0mMark as Confirmed[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</li>[39m
      [36m</ul>[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 â¯ Object.getElementError node_modules/@testing-library/dom/dist/config.js:37:19
 â¯ getElementError node_modules/@testing-library/dom/dist/query-helpers.js:20:35
 â¯ getMultipleElementsFoundError node_modules/@testing-library/dom/dist/query-helpers.js:23:10
 â¯ node_modules/@testing-library/dom/dist/query-helpers.js:55:13
 â¯ node_modules/@testing-library/dom/dist/query-helpers.js:95:19
 â¯ src/components/ThreatPanel.test.tsx:57:19
     55|       />,
     56|     );
     57|     expect(screen.getByText(/SQL Injection \(critical\)/i)).toBeInTheDâ€¦
       |                   ^
     58|     expect(
     59|       screen.getByText(

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[7/14]âŽ¯

 FAIL  src/components/ThreatPanel.test.tsx > ThreatPanel > calls onThreatClick when a threat item is clicked
TestingLibraryElementError: Found multiple elements with the text: /SQL Injection \(critical\)/i

Here are the matching elements:

Ignored nodes: comments, script, style
[36m<span[39m
  [33mclass[39m=[32m"font-medium text-red-700"[39m
[36m>[39m
  [0mSQL Injection[0m
  [0m ([0m
  [0mcritical[0m
  [0m)[0m
[36m</span>[39m

Ignored nodes: comments, script, style
[36m<span[39m
  [33mclass[39m=[32m"font-medium text-red-700"[39m
[36m>[39m
  [0mSQL Injection[0m
  [0m ([0m
  [0mcritical[0m
  [0m)[0m
[36m</span>[39m

(If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<div[39m
      [33mclass[39m=[32m"threat-panel p-4 border rounded-lg shadow-md bg-white"[39m
    [36m>[39m
      [36m<h2[39m
        [33mclass[39m=[32m"text-lg font-semibold mb-4"[39m
      [36m>[39m
        [0mDetected Threats[0m
      [36m</h2>[39m
      [36m<ul[39m
        [33mclass[39m=[32m"space-y-2"[39m
      [36m>[39m
        [36m<li[39m
          [33mclass[39m=[32m"p-3 border rounded-md bg-red-50 hover:bg-red-100"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"cursor-pointer"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex justify-between items-center"[39m
            [36m>[39m
              [36m<span[39m
                [33mclass[39m=[32m"font-medium text-red-700"[39m
              [36m>[39m
                [0mSQL Injection[0m
                [0m ([0m
                [0mcritical[0m
                [0m)[0m
              [36m</span>[39m
              [36m<span[39m
                [33mclass[39m=[32m"text-sm text-gray-500"[39m
              [36m>[39m
                [0m3/15/2023, 9:20:00 AM[0m
              [36m</span>[39m
            [36m</div>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-sm text-red-600 mt-1"[39m
            [36m>[39m
              [0mPotential SQL Injection detected in HTTP request (encoding: none)[0m
            [36m</p>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-xs text-gray-400 mt-1"[39m
            [36m>[39m
              [0mMITRE ATT&CK: [0m
              [0mT1190[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex justify-end gap-2 mt-2"[39m
          [36m>[39m
            [36m<button[39m
              [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground h-8 rounded-md px-3 text-xs"[39m
            [36m>[39m
              [0mMark as False Positive[0m
            [36m</button>[39m
            [36m<button[39m
              [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 bg-primary text-primary-foreground shadow hover:bg-primary/90 h-8 rounded-md px-3 text-xs"[39m
            [36m>[39m
              [0mMark as Confirmed[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</li>[39m
        [36m<li[39m
          [33mclass[39m=[32m"p-3 border rounded-md bg-red-50 hover:bg-red-100"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"cursor-pointer"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex justify-between items-center"[39m
            [36m>[39m
              [36m<span[39m
                [33mclass[39m=[32m"font-medium text-red-700"[39m
              [36m>[39m
                [0mSQL Injection[0m
                [0m ([0m
                [0mcritical[0m
                [0m)[0m
              [36m</span>[39m
              [36m<span[39m
                [33mclass[39m=[32m"text-sm text-gray-500"[39m
              [36m>[39m
                [0m3/15/2023, 9:21:00 AM[0m
              [36m</span>[39m
            [36m</div>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-sm text-red-600 mt-1"[39m
            [36m>[39m
              [0mPotential SQL Injection detected in HTTP request (encoding: url)[0m
            [36m</p>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-xs text-gray-400 mt-1"[39m
            [36m>[39m
              [0mMITRE ATT&CK: [0m
              [0mT1190[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex justify-end gap-2 mt-2"[39m
          [36m>[39m
            [36m<button[39m
              [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground h-8 rounded-md px-3 text-xs"[39m
              [33mdisabled[39m=[32m""[39m
            [36m>[39m
              [0mFalse Positive (Marked)[0m
            [36m</button>[39m
            [36m<button[39m
              [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 bg-primary text-primary-foreground shadow hover:bg-primary/90 h-8 rounded-md px-3 text-xs"[39m
            [36m>[39m
              [0mMark as Confirmed[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</li>[39m
      [36m</ul>[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 â¯ Object.getElementError node_modules/@testing-library/dom/dist/config.js:37:19
 â¯ getElementError node_modules/@testing-library/dom/dist/query-helpers.js:20:35
 â¯ getMultipleElementsFoundError node_modules/@testing-library/dom/dist/query-helpers.js:23:10
 â¯ node_modules/@testing-library/dom/dist/query-helpers.js:55:13
 â¯ node_modules/@testing-library/dom/dist/query-helpers.js:95:19
 â¯ src/components/ThreatPanel.test.tsx:76:28
     74|       />,
     75|     );
     76|     fireEvent.click(screen.getByText(/SQL Injection \(critical\)/i));
       |                            ^
     77|     expect(handleThreatClick).toHaveBeenCalledWith('packet-1');
     78|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[8/14]âŽ¯

 FAIL  src/components/ThreatPanel.test.tsx > ThreatPanel > calls onUpdateThreatStatus with "confirmed" when "Mark as Confirmed" button is clicked
TestingLibraryElementError: Found multiple elements with the role "button" and name `/Mark as Confirmed/i`

Here are the matching elements:

Ignored nodes: comments, script, style
[36m<button[39m
  [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 bg-primary text-primary-foreground shadow hover:bg-primary/90 h-8 rounded-md px-3 text-xs"[39m
[36m>[39m
  [0mMark as Confirmed[0m
[36m</button>[39m

Ignored nodes: comments, script, style
[36m<button[39m
  [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 bg-primary text-primary-foreground shadow hover:bg-primary/90 h-8 rounded-md px-3 text-xs"[39m
[36m>[39m
  [0mMark as Confirmed[0m
[36m</button>[39m

(If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<div[39m
      [33mclass[39m=[32m"threat-panel p-4 border rounded-lg shadow-md bg-white"[39m
    [36m>[39m
      [36m<h2[39m
        [33mclass[39m=[32m"text-lg font-semibold mb-4"[39m
      [36m>[39m
        [0mDetected Threats[0m
      [36m</h2>[39m
      [36m<ul[39m
        [33mclass[39m=[32m"space-y-2"[39m
      [36m>[39m
        [36m<li[39m
          [33mclass[39m=[32m"p-3 border rounded-md bg-red-50 hover:bg-red-100"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"cursor-pointer"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex justify-between items-center"[39m
            [36m>[39m
              [36m<span[39m
                [33mclass[39m=[32m"font-medium text-red-700"[39m
              [36m>[39m
                [0mSQL Injection[0m
                [0m ([0m
                [0mcritical[0m
                [0m)[0m
              [36m</span>[39m
              [36m<span[39m
                [33mclass[39m=[32m"text-sm text-gray-500"[39m
              [36m>[39m
                [0m3/15/2023, 9:20:00 AM[0m
              [36m</span>[39m
            [36m</div>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-sm text-red-600 mt-1"[39m
            [36m>[39m
              [0mPotential SQL Injection detected in HTTP request (encoding: none)[0m
            [36m</p>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-xs text-gray-400 mt-1"[39m
            [36m>[39m
              [0mMITRE ATT&CK: [0m
              [0mT1190[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex justify-end gap-2 mt-2"[39m
          [36m>[39m
            [36m<button[39m
              [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground h-8 rounded-md px-3 text-xs"[39m
            [36m>[39m
              [0mMark as False Positive[0m
            [36m</button>[39m
            [36m<button[39m
              [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 bg-primary text-primary-foreground shadow hover:bg-primary/90 h-8 rounded-md px-3 text-xs"[39m
            [36m>[39m
              [0mMark as Confirmed[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</li>[39m
        [36m<li[39m
          [33mclass[39m=[32m"p-3 border rounded-md bg-red-50 hover:bg-red-100"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"cursor-pointer"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex justify-between items-center"[39m
            [36m>[39m
              [36m<span[39m
                [33mclass[39m=[32m"font-medium text-red-700"[39m
              [36m>[39m
                [0mSQL Injection[0m
                [0m ([0m
                [0mcritical[0m
                [0m)[0m
              [36m</span>[39m
              [36m<span[39m
                [33mclass[39m=[32m"text-sm text-gray-500"[39m
              [36m>[39m
                [0m3/15/2023, 9:21:00 AM[0m
              [36m</span>[39m
            [36m</div>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-sm text-red-600 mt-1"[39m
            [36m>[39m
              [0mPotential SQL Injection detected in HTTP request (encoding: url)[0m
            [36m</p>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-xs text-gray-400 mt-1"[39m
            [36m>[39m
              [0mMITRE ATT&CK: [0m
              [0mT1190[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex justify-end gap-2 mt-2"[39m
          [36m>[39m
            [36m<button[39m
              [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground h-8 rounded-md px-3 text-xs"[39m
              [33mdisabled[39m=[32m""[39m
            [36m>[39m
              [0mFalse Positive (Marked)[0m
            [36m</button>[39m
            [36m<button[39m
              [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 bg-primary text-primary-foreground shadow hover:bg-primary/90 h-8 rounded-md px-3 text-xs"[39m
            [36m>[39m
              [0mMark as Confirmed[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</li>[39m
      [36m</ul>[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 â¯ Object.getElementError node_modules/@testing-library/dom/dist/config.js:37:19
 â¯ getElementError node_modules/@testing-library/dom/dist/query-helpers.js:20:35
 â¯ getMultipleElementsFoundError node_modules/@testing-library/dom/dist/query-helpers.js:23:10
 â¯ node_modules/@testing-library/dom/dist/query-helpers.js:55:13
 â¯ node_modules/@testing-library/dom/dist/query-helpers.js:95:19
 â¯ src/components/ThreatPanel.test.tsx:108:36
    106|       />,
    107|     );
    108|     const confirmedButton = screen.getByRole('button', {
       |                                    ^
    109|       name: /Mark as Confirmed/i,
    110|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[9/14]âŽ¯

 FAIL  src/utils/sqlInjectionDetector.test.ts > SQL Injection Detector > should detect classic SQL injection in GET query parameter (URL-encoded)
AssertionError: expected [ { offset: 6, length: 11 } ] to deeply equal [ { offset: 6, length: 14 } ]

- Expected
+ Received

  [
    {
-     "length": 14,
+     "length": 11,
      "offset": 6,
    },
  ]

 â¯ src/utils/sqlInjectionDetector.test.ts:53:37
     51|     expect(threats[0].mitreAttack).toEqual(['T1190']);
     52|     expect(threats[0].description).toContain('query string (encoding: â€¦
     53|     expect(threats[0].matchDetails).toEqual([{ offset: 6, length: 14 }â€¦
       |                                     ^
     54|   });
     55| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[10/14]âŽ¯

 FAIL  src/utils/sqlInjectionDetector.test.ts > SQL Injection Detector > should detect boolean-based OR 1=2 (none encoded)
AssertionError: expected [] to have a length of 1 but got +0

- Expected
+ Received

- 1
+ 0

 â¯ src/utils/sqlInjectionDetector.test.ts:156:21
    154|     const threats = detectSqlInjection(mockPacket);
    155| 
    156|     expect(threats).toHaveLength(1);
       |                     ^
    157|     expect(threats[0].type).toBe('SQL Injection');
    158|     expect(threats[0].description).toContain('query string (encoding: â€¦

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[11/14]âŽ¯

 FAIL  src/utils/sqlInjectionDetector.test.ts > SQL Injection Detector > should handle multiple matches within the same field and encoding, aggregating matchDetails
AssertionError: expected 2 to be 3 // Object.is equality

- Expected
+ Received

- 3
+ 2

 â¯ src/utils/sqlInjectionDetector.test.ts:233:45
    231|     expect(threats[0].type).toBe('SQL Injection');
    232|     expect(threats[0].description).toContain('query string (encoding: â€¦
    233|     expect(threats[0].matchDetails?.length).toBe(3); // Three patternsâ€¦
       |                                             ^
    234|     // Ensure both patterns are detected and their matchDetails are prâ€¦
    235|     const decodedQueryString = "q=test' OR '1'='1;WAITFOR DELAY '00:00â€¦

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[12/14]âŽ¯

 FAIL  src/utils/sqlInjectionPatterns.test.ts > SQL Injection Patterns > boolean-based patterns > should detect OR 1=2
AssertionError: expected 'OR 1=2' to match /AND\s+(?:TRUE|FALSE)/gi

- Expected: 
/AND\s+(?:TRUE|FALSE)/gi

+ Received: 
"OR 1=2"

 â¯ src/utils/sqlInjectionPatterns.test.ts:76:24
     74| 
     75|     it('should detect OR 1=2', () => {
     76|       expect('OR 1=2').toMatch(sqlInjectionPatterns.booleanBased[1]);
       |                        ^
     77|       expect("OR '1'='2'").toMatch(sqlInjectionPatterns.booleanBased[1â€¦
     78|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[13/14]âŽ¯

 FAIL  src/utils/sqlInjectionPatterns.test.ts > SQL Injection Patterns > boolean-based patterns > should detect AND TRUE/FALSE
AssertionError: expected 'AND TRUE' to match /OR\s+(?:TRUE|FALSE)/gi

- Expected: 
/OR\s+(?:TRUE|FALSE)/gi

+ Received: 
"AND TRUE"

 â¯ src/utils/sqlInjectionPatterns.test.ts:81:26
     79| 
     80|     it('should detect AND TRUE/FALSE', () => {
     81|       expect('AND TRUE').toMatch(sqlInjectionPatterns.booleanBased[2]);
       |                          ^
     82|       expect('AND FALSE').toMatch(sqlInjectionPatterns.booleanBased[2]â€¦
     83|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[14/14]âŽ¯


 Test Files  5 failed | 19 passed (24)
      Tests  14 failed | 182 passed (196)
   Start at  12:04:18
   Duration  52.68s (transform 5.79s, setup 8.55s, import 20.50s, tests 46.06s, environment 63.35s)

